#!/bin/sh

echo "ğŸ“ Validating commit message..."

# ValidaÃ§Ã£o com commitlint
npx --no-install commitlint --edit "$1"

if [ $? -ne 0 ]; then
  echo "âŒ Commit message validation failed!"
  echo ""
  echo "ğŸ“‹ Expected format: type(scope): subject"
  echo "ğŸ“‹ Example: feat(auth): add user authentication"
  echo "ğŸ“‹ Types: feat, fix, docs, style, refactor, test, chore, perf, ci, build, revert"
  exit 1
fi

# Checagem de assinaturas de IA proibidas
if grep -q "ğŸ¤– Generated with \[Claude Code\]" "$1" || grep -q "Co-Authored-By: Claude <noreply@anthropic.com>" "$1"; then
  echo "âŒ Commits com assinatura de IA nÃ£o sÃ£o permitidos."
  echo "   Remova qualquer referÃªncia a Claude Code ou Co-Authored-By: Claude."
  exit 1
fi

echo "âœ… Commit message is valid!"
